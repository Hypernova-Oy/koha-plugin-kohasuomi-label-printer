#!/usr/env perl

use Modern::Perl;
use strict;
use warnings;

use Test::More;

use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::DataSourceFormatter;
use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Image;
use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Sheet::Dimensions;
use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Sheet::Element;
use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Sheet::Position;
use Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Sheet::Region;

my $imagedataBase64 = "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";

my $img = Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Image->new($imagedataBase64);
is($img->width, 136, "img width");
is($img->height, 188, "img height");

my $badImagedataBase64 = "\xFF\x01i4509y0923f0932f0932jf09j32fj320f32jf3209jf0932fj32f9j32f0j209jf09j32f09j3209fj3209jf0932";
eval {
  $img = Koha::Plugin::Fi::KohaSuomi::LabelPrinter::Image->new($badImagedataBase64);
};
ok($@, "Bad image data caught: $@");

